{% extends 'base.html' %}
{% block content %}
{% load static %}

<link rel="stylesheet" href="{% static 'css/profile.css' %}">
<div class="profilePage">
    <div class="profileBody">
        <div class="ProfileDetials">
            <h3>user: {{user.username}}</h3>
            <div class="ProfileBox">
                <img id="portholeImg" src="{%static 'images/porthole.png' %}" alt="">
                {% if user.profile_image %}
                <img id="profileImg" src="{{user.profile_image.url}}" alt="{{user.username}}'s profile image">
                {% else %}
                <img id="profileImg" style="width: 77%;" src="{%static 'images/default_profile_img.png' %}"
                    alt="Default Image">
                {% endif %}
            </div>

            <p>total votes: {{total_votes}}</p>

            {% if request.user.is_authenticated %}
            {% if user != request.user %}
            <form enctype="multipart/form-data" action="/sendmessage/{{user.username}}/" method="POST">
                {% csrf_token %}
                {{message_form.as_p}}
                <input type="submit" value="Send Message">
            </form>
            {% if is_followed %}
            <a href="/follow/{{user.username}}/" id="linkButton">Unfollow</a>
            {% else %}
            <a href="/follow/{{user.username}}/" id="linkButton">Follow</a>
            {% endif %}
            {% endif %}
            {% endif %}



            {% if user.bio %}
            <p>bio: {{user.bio}}</p>
            {% endif %}

            <p>email: {{user.email}}</p>
            {% if user == request.user %}
            <br>
            <a href="/updateuser/{{user.id}}/" id="UpdateProfileButton">update profile</a>
            {% if messages %}
            {% for message in messages %}
            <h3>{{message}}</h3>
            {% endfor %}
            {% endif %}
            {% endif %}
        </div>
        <div class="ProfileFollowlist">
            {% if followers %}
            <h5>Users Following:</h5>
            {% for follower in followers %}
            <li><a href="/users/{{follower.username}}/" id="linkButton">{{follower}}</a></li>
            {% endfor %}
            {% endif %}
        </div>

        <div class="ProfileSubsList">
            {% if subs %}
            <h5>Nets Subscribed:</h5>
            {% for sub in subs %}
            <li><a href="/nets/{{sub.title}}/" id="linkButton">n/{{sub}}</a></li>
            {% endfor %}
            {% endif %}
        </div>



    </div>

    <div class="profilePostList">
        {% if posts %}
        <h3>{{user.username}}'s posts:</h3>
        {% for post in posts %}
        <div class="profilePostBox">
            {% if post.post_type == "Post" %}
            <div class="profilePostHeader">
                <p class="profilePost">Posted in
                    <a href="/nets/{{post.subnet.title}}/" id="linkButton">n/{{post.subnet.title}}</a>
                    :
            </div>
            <div class="profilePostBody">
                <a href="/posts/{{post.id}}/" id="linkButton">{{post.header}}</a>
                {% if post.content %}
                <p>{{post.content}}</p>
                {% endif %}

                {% if post.image %}
                <br>
                <img style="width: 300px;" src="{{post.image.url}}" alt="{{post.image}}">
                {% endif %}



            </div>
            </p>
            {% else %}
            <div class="profilePostHeader">
                <p class="profileComment">Commented on
                    <a href="/posts/{{post.root.id}}/" id="linkButton">post</a>
                    :
            </div>
            <div class="profilePostBody"><a href="/posts/{{post.parent.id}}/" id="linkButton">{{post.header}}</a></div>
            </p>
            {% endif %}
            <div class="profilePostFooter">
                <p>total votes: {{post.total_score}} posted: {{post.time_ago}}</p>
            </div>
        </div>
        {% endfor %}
        {% endif %}
    </div>
</div>
{% endblock %}